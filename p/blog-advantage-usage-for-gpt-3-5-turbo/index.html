<!doctype html><html lang=zh-cn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Advantage Usage for GPT 3.5 Turbo API | 小冰爱吃盐</title>
<meta name=keywords content="aigc,,gpt,,openai,,blog"><meta name=description content="Advantage Usage for OpenAI GPT 3.5 Turbo API, 文章主要介绍了 GPT 3.5 Turbo API 的进阶玩法，包括全部参数的解读和代码样例，例如：stream、temperature、top_p、presence_penalty等等，以及我的一些关于 AIGC 和 ChatGPT 的理解。"><meta name=author content="北屿"><link rel=canonical href=https://blog.bj-yan.top/p/blog-advantage-usage-for-gpt-3-5-turbo/><meta name=google-site-verification content="G-PRK0FMMDH1"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.min.8d0a354998e71ab0f222ae59ef33b3acb610ae9b11671c8d8c5ab4a9bfbe09b7.css integrity="sha256-jQo1SZjnGrDyIq5Z7zOzrLYQrpsRZxyNjFq0qb++Cbc=" rel="preload stylesheet" as=style><link rel=preload href=/favicon.jpg as=image><link rel=icon href=https://blog.bj-yan.top/favicon.jpg><link rel=icon type=image/png sizes=16x16 href=https://blog.bj-yan.top/favicon.jpg><link rel=icon type=image/png sizes=32x32 href=https://blog.bj-yan.top/favicon.jpg><link rel=apple-touch-icon href=https://blog.bj-yan.top/favicon.jpg><link rel=mask-icon href=https://blog.bj-yan.top/favicon.jpg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.136.5"><link rel=alternate hreflang=zh-cn href=https://blog.bj-yan.top/p/blog-advantage-usage-for-gpt-3-5-turbo/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?d396c00ca4fe6547a19249d34cb91254",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><script type=text/javascript async src="https://cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["[[","]]"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"})</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style><link href=//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet><script async src="https://www.googletagmanager.com/gtag/js?id=G-DC28LRQ4E5"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-DC28LRQ4E5")}</script><meta property="og:title" content="Advantage Usage for GPT 3.5 Turbo API"><meta property="og:description" content="Advantage Usage for OpenAI GPT 3.5 Turbo API, 文章主要介绍了 GPT 3.5 Turbo API 的进阶玩法，包括全部参数的解读和代码样例，例如：stream、temperature、top_p、presence_penalty等等，以及我的一些关于 AIGC 和 ChatGPT 的理解。"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.bj-yan.top/p/blog-advantage-usage-for-gpt-3-5-turbo/"><meta property="og:image" content="https://blog.bj-yan.top/favicon.jpg"><meta property="article:section" content="post"><meta property="article:published_time" content="2023-03-02T19:19:58+08:00"><meta property="article:modified_time" content="2023-03-21T12:52:17+08:00"><meta property="og:site_name" content="小冰爱吃盐"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.bj-yan.top/favicon.jpg"><meta name=twitter:title content="Advantage Usage for GPT 3.5 Turbo API"><meta name=twitter:description content="Advantage Usage for OpenAI GPT 3.5 Turbo API, 文章主要介绍了 GPT 3.5 Turbo API 的进阶玩法，包括全部参数的解读和代码样例，例如：stream、temperature、top_p、presence_penalty等等，以及我的一些关于 AIGC 和 ChatGPT 的理解。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.bj-yan.top/post/"},{"@type":"ListItem","position":2,"name":"Advantage Usage for GPT 3.5 Turbo API","item":"https://blog.bj-yan.top/p/blog-advantage-usage-for-gpt-3-5-turbo/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Advantage Usage for GPT 3.5 Turbo API","name":"Advantage Usage for GPT 3.5 Turbo API","description":"Advantage Usage for OpenAI GPT 3.5 Turbo API, 文章主要介绍了 GPT 3.5 Turbo API 的进阶玩法，包括全部参数的解读和代码样例，例如：stream、temperature、top_p、presence_penalty等等，以及我的一些关于 AIGC 和 ChatGPT 的理解。","keywords":["aigc,","gpt,","openai,","blog"],"articleBody":"引言 今天(2023.03.02) OpenAI 发布了 GPT 3.5 Turbo 最新的 API，目前定价是 $0.002/1k tokens1。\nwarning\n本文信息具有时效性，请注意辨别。 使用指南 Usage 官方文档在这里2，显然会比我写的更详细 233，没意外还是建议查看官方文档。\n我写完发现，可能还真没我写的详细！233\n注册 Register warning\n这里可能需要一个自由的网络环境，同时提一嘴，如果你是使用的代理软件，那么在下面运行程序的时候需要在命令行中环境中设置 `HTTP_PROXY` 和 `HTTPS_PROXY`，否则会访问错误。Windows 下可以使用 `set` 命令，`set HTTP_PROXY=http://127.0.0.1:xxxx`，Linux 下可以使用 `export` 命令，`export HTTP_PROXY=http://127.0.0.1:xxxx`，`xxxx` 为代理软件端口号。 首先得在 OpenAI Platform 注册一个开发者账号，随后在 API Keys 页面生成一个 API Key。\n创建 APIKEY\n目前，OpenAI 提供了 $18 一个月的免费额度，用来测试应该是绰绰有余了。\n一个月的免费额度\nDemo Example 现在直接上手！在开始前需要先安装一下 openai 库，目前最新版本是 v0.27.0。\n1 pip install openai 如果你之前安装过，那么你可能需要升级一下\n1 pip install openai --upgrade 下面是一个官方提供的 Demo，将里面的 API key 文本替换成你自己的就可以直接运行了。\n1 2 3 4 5 6 7 8 9 10 11 import os import openai os.environ[\"OPENAI_API_KEY\"] = \"sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\" # replace with your API key openai.api_key = os.getenv(\"OPENAI_API_KEY\") completion = openai.ChatCompletion.create( model=\"gpt-3.5-turbo\", messages=[{\"role\": \"user\", \"content\": \"Hello!\"}] ) print(completion.choices[0].message) Say Hi to GPT 3.5 Turbo\n这样我们成功跟 GPT 3.5 Turbo 打了个招呼！\nAdvanced Usage # 1 我们先来看一个更长的栗子\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 import os import openai os.environ[\"OPENAI_API_KEY\"] = \"sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\" # replace with your API key openai.api_key = os.getenv(\"OPENAI_API_KEY\") completion = openai.ChatCompletion.create( model=\"gpt-3.5-turbo\", messages=[ {\"role\": \"system\", \"content\": \"You are a helpful assistant.\"}, {\"role\": \"user\", \"content\": \"Who won the world series in 2020?\"}, { \"role\": \"assistant\", \"content\": \"The Los Angeles Dodgers won the World Series in 2020.\", }, {\"role\": \"user\", \"content\": \"Where was it played?\"}, ], ) print(completion.choices[0].message) 首先需要利用 openai 库的 ChatCompletion 后调用 create 方法来创建一个 ChatCompletion 对象，这个对象中包含了我们的请求信息。\n观察一下请求的格式：\nmodel: 这个不用多说，便是模型的名称，目前现在我们在测试 gpt-3.5-turbo 这个模型，并且目前仅支持两个模型，gpt-3.5-turbo 和 gpt-3.5-turbo-0301，后面带日期的模型是不会更新的，但对今天来说，两者是相同的。 messages: 这个是一个列表，列表中的每个元素都是一个字典，字典中的 role 表示这个消息，目前支持 user，system和assistant三种，content 表示消息的内容。 system：系统消息，用来设置 ChatGPT 的行为。 user：用户消息，用来和 ChatGPT 交互。 assistant：助理消息，用来帮助你存储 ChatGPT 在此之前的回复。 来看一下完整的回复\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 { \"choices\": [ { \"finish_reason\": \"stop\", \"index\": 0, \"message\": { \"content\": \"The 2020 World Series was played at Globe Life Field in Arlington, Texas.\", \"role\": \"assistant\" } } ], \"created\": 1677759714, \"id\": \"chatcmpl-6pcEUG6zKP0Ld33OP1dZGbg3GwWhC\", \"model\": \"gpt-3.5-turbo-0301\", \"object\": \"chat.completion\", \"usage\": { \"completion_tokens\": 19, \"prompt_tokens\": 56, \"total_tokens\": 75 } } 这其实就是一个多轮对话的栗子，如果是想动态的进行多轮对话，那么必须每次都将之前的回复都记录并传入才行。\n首先我们设置了 system 的消息，这个消息的内容是 You are a helpful assistant.，随后我们设置了 user 的消息，这个消息的内容是 Who won the world series in 2020?，这个消息相当于前一轮对话的信息，然后我们设置了 assistant 的消息，这个消息的内容是 The Los Angeles Dodgers won the World Series in 2020.，意思是 ChatGPT 在上一轮的回复。最后我们又设置了 user 的消息，这个消息的内容是 Where was it played?，表示本轮消息的问题，也就是当前想让 GPT 回复的问题。\n可以看到，收到的回复内容是 The 2020 World Series was played at Globe Life Field in Arlington, Texas.，我们询问时只询问了地点，而 ChatGPT 已经通过之前的回复，知道了这次的回复是关于 2020 年世界系列赛的，并且回答了这个问题。\n同时，我们还可以看到 usage 字段，这个字段表示这次请求使用了多少 token，prompt_tokens 输入的 token 数量，completion_tokens 是 ChatGPT 回复的 token 数量，total_tokens 是总共使用的 token 数量，这一波消耗了 75 个 token。\nAdvanced Usage # 2 我们再来看一个更复杂的栗子\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 import os import openai os.environ[\"OPENAI_API_KEY\"] = \"sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\" # replace with your API key openai.api_key = os.getenv(\"OPENAI_API_KEY\") completion = openai.ChatCompletion.create( model=\"gpt-3.5-turbo\", messages=[ { \"role\": \"user\", \"content\": 'I want you to act as an Chinese translator, spelling corrector and improver. I will speak to you in any language and you will detect the language, translate it and answer in the corrected and improved version of my text, in Chinese. I want you to replace my simplified A0-level words and sentences with more beautiful and elegant, upper level Chinese words and sentences. Keep the meaning same, but make them more literary. I want you to only reply the correction, the improvements and nothing else, do not write explanations. My first sentence is \"Non terrae plus ultra\"', }, ], temperature=0.9, # 0.0 to 2.0 (default 1.0) top_p=1, # 0.0 to 1.0 (default 1.0) (not used if temperature is set) n=5, # number (default 1) How many chat completion choices to generate for each input message. stream=False, # boolean (default False) stop=None, # string or array (default None) max_tokens=10, # inf (default 4096-prompt_token) presence_penalty=2.0, # -2.0 to 2.0 (default 0) frequency_penalty=0, # -2.0 to 2.0 (default 0) # logit_bias= # user= ) print(completion) for choice in completion.choices: print(choice.message.content) 这里的 prompt 修改自 3，prompt 与我想解释的参数无关\n这里面涉及到了更多的参数：\ntemperature: 0.0 to 2.0 (默认 1.0) 温度，越高越随机，越低越有规律（或确定性）。\ntop_p: 0.0 to 1.0 (默认 1.0) 使用温度的另一种选择，也叫核采样（nucleus sampling），建议不要同时使用 temperature 和 top_p。top_p 表示模型只考虑概率最高的 top_p 的 token，比如 top_p=0.1，表示模型只考虑概率最高的 10% 的 token。\nn: number (默认 1) 生成的回复数量。\nstream: boolean (默认 False) 是否使用流式模式，如果设置为 True，将发送部分消息增量，就像在 ChatGPT 中一样。什么意思捏，就是每次单独给你蹦几个词，好让你动态的去更新文本，像你在 ChatGPT 中等待完整的回复一样。\nstop: string or array (默认 None) 用来停止生成的 token，可以是一个字符串，也可以是一个字符串列表，如果是字符串列表，那么只要其中一个 token 出现，就会停止生成，最多 4 个。\nmax_tokens: inf (默认 4096-prompt_token) 生成的最大 token 数量。\nfrequency_penalty 和 presence_penalty: -2.0 to 2.0 (默认 0) 用来惩罚重复的 token。关于此参数的更多细节在 4 中有介绍，看起来一个是处理的频率，一个是处理的存在次数（整数）。这两个参数的值越大，生成的文本越不会重复。\n公式是这样的：\n1 mu[j] -\u003e mu[j] - c[j] * alpha_frequency - float(c[j] \u003e 0) * alpha_presence logit_bias: dict (默认 None) 用来调整 token 的概率，可以接受 json。数值是 -100 to 100，-100 相当于直接禁用这个词，100 相当于如果相关就必须使用。\nuser: dict (默认 None) 用来设置用户的信息，具体内容可以参考 5，主要是为了防止滥用。\n而这段代码的输出是下面内容（因为中文在 json 中会有转义，所以这里我把中文替换过了）。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 { \"choices\": [ { \"finish_reason\": \"stop\", \"index\": 0, \"message\": { \"content\": \"\\\"天涯海角\\\"\", \"role\": \"assistant\" } }, { \"finish_reason\": \"stop\", \"index\": 1, \"message\": { \"content\": \"\\n\\n无穷尽之地\", \"role\": \"assistant\" } }, { \"finish_reason\": null, \"index\": 2, \"message\": { \"content\": \"\\n\\n\\\"无出其右\\\"\", \"role\": \"assistant\" } }, { \"finish_reason\": \"stop\", \"index\": 3, \"message\": { \"content\": \"\\n\\n\\\"无地不可至\\\"\", \"role\": \"assistant\" } }, { \"finish_reason\": \"length\", \"index\": 4, \"message\": { \"content\": \"\\n\\n无地可往，更远\", \"role\": \"assistant\" } } ], \"created\": 1677760749, \"id\": \"chatcmpl-6pcVBkXoD9xr2CSioR1Gz3ubEOdpg\", \"model\": \"gpt-3.5-turbo-0301\", \"object\": \"chat.completion\", \"usage\": { \"completion_tokens\": 45, \"prompt_tokens\": 124, \"total_tokens\": 169 } } Advanced Usage # 3 这里是关于 steam 参数的一个栗子\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 import os import openai os.environ[\"OPENAI_API_KEY\"] = \"sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\" openai.api_key = os.getenv(\"OPENAI_API_KEY\") completion = openai.ChatCompletion.create( model=\"gpt-3.5-turbo\", messages=[ { \"role\": \"user\", \"content\": 'I want you to act as an Chinese translator, spelling corrector and improver. I will speak to you in any language and you will detect the language, translate it and answer in the corrected and improved version of my text, in Chinese. I want you to replace my simplified A0-level words and sentences with more beautiful and elegant, upper level Chinese words and sentences. Keep the meaning same, but make them more literary. I want you to only reply the correction, the improvements and nothing else, do not write explanations. My first sentence is \"Non terrae plus ultra\"', }, ], temperature=1, # 0.0 to 2.0 (default 1.0) top_p=1, # 0.0 to 1.0 (default 1.0) (not used if temperature is set) n=1, # number (default 1) How many chat completion choices to generate for each input message. stream=True, # boolean (default False) stop=None, # string or array (default None) # max_tokens=100, # inf (default 4096-prompt_token) presence_penalty=2.0, # -2.0 to 2.0 (default 0) frequency_penalty=0, # -2.0 to 2.0 (default 0) # logit_bias= # user= ) for completion_ in completion: # print(completion_) for choice in completion_.choices: print(choice.delta.content if \"content\" in choice.delta else \"\") 开启 Stream 模式后，返回的会是流式数据，而不是返回一个包含所有数据的对象，并且这个返回的对象是可以迭代的。下面是返回的一个 item 样例，这里注意 delta 中未必会有 content，所以需要判断一下。\n也就是说，其实 ChatGPT 在输出前就已经得到了完整的结果，他一个词一个词蹦纯属在前端拖延你的时间？！\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 { \"choices\": [ { \"delta\": { \"content\": \"\\uff1f\" }, \"finish_reason\": null, \"index\": 0 } ], \"created\": 1677763452, \"id\": \"chatcmpl-6pdCm5jwsB1e3YyEDZ1MQXbpHzWvn\", \"model\": \"gpt-3.5-turbo-0301\", \"object\": \"chat.completion.chunk\" } Advanced Usage # 4 这是一个关于 stop 参数的栗子\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 import os import openai os.environ[\"OPENAI_API_KEY\"] = \"sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\" openai.api_key = os.getenv(\"OPENAI_API_KEY\") completion = openai.ChatCompletion.create( model=\"gpt-3.5-turbo\", messages=[ { \"role\": \"user\", \"content\": 'I want you to act as an Chinese translator, spelling corrector and improver. I will speak to you in any language and you will detect the language, translate it and answer in the corrected and improved version of my text, in Chinese. I want you to replace my simplified A0-level words and sentences with more beautiful and elegant, upper level Chinese words and sentences. Keep the meaning same, but make them more literary. I want you to only reply the correction, the improvements and nothing else, do not write explanations. My first sentence is \"Non terrae plus ultra\"', }, ], temperature=1, # 0.0 to 2.0 (default 1.0) top_p=1, # 0.0 to 1.0 (default 1.0) (not used if temperature is set) n=1, # number (default 1) How many chat completion choices to generate for each input message. stream=False, # boolean (default False) stop=\"无\", # string or array (default None) # max_tokens=100, # inf (default 4096-prompt_token) presence_penalty=0, # -2.0 to 2.0 (default 0) frequency_penalty=0, # -2.0 to 2.0 (default 0) # logit_bias= # user= ) for choice in completion.choices: print(choice.message.content) 这里我们依然让他扮演一个翻译的角色，来翻译 Apex Legends 中动力小子的一句台词，用 “无” 作为停止条件，当输出的结果中遇到 “无” 时，就停止并返回结果。输出如下：\n1 您好，您所给出的第一句话“Non terrae plus ultra”是拉丁语，意为“没有比这更远的土地”，翻译成中文可写作“ 可以看到输出直接给断开了，并且会将中断的词自动转为 token，不过我暂时还没想到有啥应用场景 - -\nError 在使用的时候我有好几次触发了这个错误，并不是我请求格式的问题，大概是同时请求的人太多了，所以会出现这个错误，这个错误的信息是下面这样的：\n1 2 3 4 5 6 7 8 9 openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 7d8d2f6b67d92ff7850ef3e17d742827 in your email.) { \"error\": { \"message\": \"The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 7d8d2f6b67d92ff7850ef3e17d742827 in your email.)\", \"type\": \"server_error\", \"param\": null, \"code\": null } } 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 7d8d2f6b67d92ff7850ef3e17d742827 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} {'Date': 'Thu, 02 Mar 2023 12:37:21 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'Openai-Model': 'gpt-3.5-turbo-0301', 'Openai-Organization': 'user-8qnumkqgd3l02hvzq5rqz0y1', 'Openai-Processing-Ms': '750', 'Openai-Version': '2020-10-01', 'Strict-Transport-Security': 'max-age=15724800; includeSubDomains', 'X-Request-Id': '7d8d2f6b67d92ff7850ef3e17d742827'} 结语 这个定价我只能说，实在是太便宜了，感觉很多公司可能都不会去想办法复现了，直接调包，性能好，不需要担心成本、电费、算力等种种因素，价格还便宜。我感觉小公司就算有自己模型，光算力和电力成本可能比 API 高不少，毕竟这也是一个利用率的问题。\n另外我感觉这个其实也一定程度上改变了翻译市场，以腾讯云的翻译 API 为例，他的价格稍微计算一下，大概是 GPT 3.5 Turbo API 价格的 3 倍左右，但是算上输入的 token，也就 1.5 倍吧，但是附赠了其他功能，包括改写润色。\n腾讯云翻译 API 价格\n通过体验也可以发现，如果你每次都是长文本输入，其实消耗 token 还是挺快的，输入输出都会计费。同时，如果你想进行 session 级别的对话，那么你消耗的 token 也会增长很快，每次 * 2，再累计，也就是平方级别的了，所以长对话的消耗其实还是挺大的。\n不过，遗憾的是，目前 OpenAI 只支持虚拟信用卡支付，国内用户想自费使用的话，可能还得有些自己的手段。\n还记得，去年 9 月份我写了一篇博客来讲讲我对 Stable Diffusion 的想法6，现在再来看看 SD 模型，简直像是差了一个世纪…lora、ControlNet…如果说 SD 只是影响到了艺术、设计领域，那么 ChatGPT 的大模型潜力是真的很大，会影响很多的行业，因为输出的多样性实在是太丰富了，比如可能会有人用他来输出一段代码，驱动机器等等7…应用的场景完全取决于想象力了，但目前也存在科学性的问题，如果有一个更强大的知识库来建立，输出时给予理论依据，那么这个模型的应用场景就会更加广泛，比如医疗、金融等等，对证据、决策要求更高的领域也会大放异彩。\nhttps://openai.com/blog/introducing-chatgpt-and-whisper-apis ↩︎\nhttps://platform.openai.com/docs/guides/chat ↩︎\nhttps://github.com/f/awesome-chatgpt-prompts ↩︎\nhttps://platform.openai.com/docs/api-reference/parameter-details ↩︎\nhttps://platform.openai.com/docs/guides/safety-best-practices/end-user-ids ↩︎\nhttps://blog.bj-yan.top/p/blog-will-ai-replace-the-artists/ ↩︎\nhttps://github.com/microsoft/PromptCraft-Robotics ↩︎\n","wordCount":"4423","inLanguage":"zh-cn","datePublished":"2023-03-02T19:19:58+08:00","dateModified":"2023-03-21T12:52:17+08:00","author":{"@type":"Person","name":"北屿"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.bj-yan.top/p/blog-advantage-usage-for-gpt-3-5-turbo/"},"publisher":{"@type":"Organization","name":"小冰爱吃盐","logo":{"@type":"ImageObject","url":"https://blog.bj-yan.top/favicon.jpg"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://blog.bj-yan.top/ accesskey=h title="Home (Alt + H)"><img src=/favicon.jpg alt=logo aria-label=logo height=35>Home</a>
<span class=logo-switches><ul class=lang-switch><li>|</li></ul></span></div><ul id=menu><li><a href=https://blog.bj-yan.top/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://blog.bj-yan.top/post/ title=Posts><span>Posts</span></a></li><li><a href=https://blog.bj-yan.top/archives title=Archive><span>Archive</span></a></li><li><a href=https://blog.bj-yan.top/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://blog.bj-yan.top/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://blog.bj-yan.top/about/ title=About><span>About</span></a></li><li><a href=https://blog.bj-yan.top/friends/ title=Friends><span>Friends</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.bj-yan.top/>Home</a>&nbsp;»&nbsp;<a href=https://blog.bj-yan.top/post/>Posts</a></div><h1 class=post-title>Advantage Usage for GPT 3.5 Turbo API</h1><div class=post-meta>March 2, 2023 · Edited March 21, 2023 · 4423 words · 9 min · 北屿&nbsp;|&nbsp;<a href=https://github.com/beiyuouo/blog-source/tree/main/content/post/blog-advantage-usage-for-gpt-3-5-turbo.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%bc%95%e8%a8%80 aria-label=引言>引言</a></li><li><a href=#%e4%bd%bf%e7%94%a8%e6%8c%87%e5%8d%97-usage aria-label="使用指南 Usage">使用指南 Usage</a><ul><li><a href=#%e6%b3%a8%e5%86%8c-register aria-label="注册 Register">注册 Register</a></li><li><a href=#demo-example aria-label="Demo Example">Demo Example</a></li><li><a href=#advanced-usage--1 aria-label="Advanced Usage # 1">Advanced Usage # 1</a></li><li><a href=#advanced-usage--2 aria-label="Advanced Usage # 2">Advanced Usage # 2</a></li><li><a href=#advanced-usage--3 aria-label="Advanced Usage # 3">Advanced Usage # 3</a></li><li><a href=#advanced-usage--4 aria-label="Advanced Usage # 4">Advanced Usage # 4</a></li><li><a href=#error aria-label=Error>Error</a></li></ul></li><li><a href=#%e7%bb%93%e8%af%ad aria-label=结语>结语</a></li></ul></div></details></div><div class=post-content><h2 id=引言>引言<a hidden class=anchor aria-hidden=true href=#引言>#</a></h2><p>今天(2023.03.02) OpenAI 发布了 GPT 3.5 Turbo 最新的 API，目前定价是 $0.002/1k tokens<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>。</p><blockquote class="book-hint2 warning"><p class="hint-title warning"><svg class="book-icon"><use href="/svg/hint-icons.svg#warning-notice"/></svg><span>warning</span></p>本文信息具有时效性，请注意辨别。</blockquote><h2 id=使用指南-usage>使用指南 Usage<a hidden class=anchor aria-hidden=true href=#使用指南-usage>#</a></h2><p>官方文档在这里<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>，显然会比我写的更详细 233，没意外还是建议查看官方文档。</p><blockquote><p>我写完发现，可能还真没我写的详细！233</p></blockquote><h3 id=注册-register>注册 Register<a hidden class=anchor aria-hidden=true href=#注册-register>#</a></h3><blockquote class="book-hint2 warning"><p class="hint-title warning"><svg class="book-icon"><use href="/svg/hint-icons.svg#warning-notice"/></svg><span>warning</span></p>这里可能需要一个自由的网络环境，同时提一嘴，如果你是使用的代理软件，那么在下面运行程序的时候需要在命令行中环境中设置 `HTTP_PROXY` 和 `HTTPS_PROXY`，否则会访问错误。Windows 下可以使用 `set` 命令，`set HTTP_PROXY=http://127.0.0.1:xxxx`，Linux 下可以使用 `export` 命令，`export HTTP_PROXY=http://127.0.0.1:xxxx`，`xxxx` 为代理软件端口号。</blockquote><p>首先得在 <a href=https://platform.openai.com/signup>OpenAI Platform</a> 注册一个开发者账号，随后在 <a href=https://platform.openai.com/account/api-keys>API Keys</a> 页面生成一个 API Key。</p><figure><img loading=lazy src=/img/blog-advantage-usage-for-gpt-3-5-turbo/create-openai-api-key.png#center alt="创建 APIKEY"><figcaption><p style=text-align:center>创建 APIKEY</p></figcaption></figure><p>目前，OpenAI 提供了 $18 一个月的免费额度，用来测试应该是绰绰有余了。</p><figure><img loading=lazy src=/img/blog-advantage-usage-for-gpt-3-5-turbo/openai-free-trial.png#center alt=一个月的免费额度><figcaption><p style=text-align:center>一个月的免费额度</p></figcaption></figure><h3 id=demo-example>Demo Example<a hidden class=anchor aria-hidden=true href=#demo-example>#</a></h3><p>现在直接上手！在开始前需要先安装一下 openai 库，目前最新版本是 <code>v0.27.0</code>。</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pip install openai
</span></span></code></pre></td></tr></table></div></div><p>如果你之前安装过，那么你可能需要升级一下</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pip install openai --upgrade
</span></span></code></pre></td></tr></table></div></div><p>下面是一个官方提供的 Demo，将里面的 API key 文本替换成你自己的就可以直接运行了。</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>os</span>
</span></span><span style=display:flex><span><span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>openai</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>os.environ[<span style=color:#ed9d13>&#34;OPENAI_API_KEY&#34;</span>] = <span style=color:#ed9d13>&#34;sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#34;</span> <span style=color:#999;font-style:italic># replace with your API key</span>
</span></span><span style=display:flex><span>openai.api_key = os.getenv(<span style=color:#ed9d13>&#34;OPENAI_API_KEY&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>completion = openai.ChatCompletion.create(
</span></span><span style=display:flex><span>    model=<span style=color:#ed9d13>&#34;gpt-3.5-turbo&#34;</span>, messages=[{<span style=color:#ed9d13>&#34;role&#34;</span>: <span style=color:#ed9d13>&#34;user&#34;</span>, <span style=color:#ed9d13>&#34;content&#34;</span>: <span style=color:#ed9d13>&#34;Hello!&#34;</span>}]
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#24909d>print</span>(completion.choices[<span style=color:#3677a9>0</span>].message)
</span></span></code></pre></td></tr></table></div></div><figure><img loading=lazy src=/img/blog-advantage-usage-for-gpt-3-5-turbo/say-hello-to-gpt-3-5.png#center alt="Say Hi to GPT 3.5 Turbo"><figcaption><p style=text-align:center>Say Hi to GPT 3.5 Turbo</p></figcaption></figure><p>这样我们成功跟 GPT 3.5 Turbo 打了个招呼！</p><h3 id=advanced-usage--1>Advanced Usage # 1<a hidden class=anchor aria-hidden=true href=#advanced-usage--1>#</a></h3><p>我们先来看一个更长的栗子</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">20
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>os</span>
</span></span><span style=display:flex><span><span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>openai</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>os.environ[<span style=color:#ed9d13>&#34;OPENAI_API_KEY&#34;</span>] = <span style=color:#ed9d13>&#34;sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#34;</span> <span style=color:#999;font-style:italic># replace with your API key</span>
</span></span><span style=display:flex><span>openai.api_key = os.getenv(<span style=color:#ed9d13>&#34;OPENAI_API_KEY&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>completion = openai.ChatCompletion.create(
</span></span><span style=display:flex><span>    model=<span style=color:#ed9d13>&#34;gpt-3.5-turbo&#34;</span>,
</span></span><span style=display:flex><span>    messages=[
</span></span><span style=display:flex><span>        {<span style=color:#ed9d13>&#34;role&#34;</span>: <span style=color:#ed9d13>&#34;system&#34;</span>, <span style=color:#ed9d13>&#34;content&#34;</span>: <span style=color:#ed9d13>&#34;You are a helpful assistant.&#34;</span>},
</span></span><span style=display:flex><span>        {<span style=color:#ed9d13>&#34;role&#34;</span>: <span style=color:#ed9d13>&#34;user&#34;</span>, <span style=color:#ed9d13>&#34;content&#34;</span>: <span style=color:#ed9d13>&#34;Who won the world series in 2020?&#34;</span>},
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#ed9d13>&#34;role&#34;</span>: <span style=color:#ed9d13>&#34;assistant&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#ed9d13>&#34;content&#34;</span>: <span style=color:#ed9d13>&#34;The Los Angeles Dodgers won the World Series in 2020.&#34;</span>,
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        {<span style=color:#ed9d13>&#34;role&#34;</span>: <span style=color:#ed9d13>&#34;user&#34;</span>, <span style=color:#ed9d13>&#34;content&#34;</span>: <span style=color:#ed9d13>&#34;Where was it played?&#34;</span>},
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#24909d>print</span>(completion.choices[<span style=color:#3677a9>0</span>].message)
</span></span></code></pre></td></tr></table></div></div><p>首先需要利用 openai 库的 <code>ChatCompletion</code> 后调用 <code>create</code> 方法来创建一个 <code>ChatCompletion</code> 对象，这个对象中包含了我们的请求信息。</p><p>观察一下请求的格式：</p><ul><li><code>model</code>: 这个不用多说，便是模型的名称，目前现在我们在测试 <code>gpt-3.5-turbo</code> 这个模型，并且目前仅支持两个模型，<code>gpt-3.5-turbo</code> 和 <code>gpt-3.5-turbo-0301</code>，后面带日期的模型是不会更新的，但对今天来说，两者是相同的。</li><li><code>messages</code>: 这个是一个列表，列表中的每个元素都是一个字典，字典中的 <code>role</code> 表示这个消息，目前支持 <code>user</code>，<code>system</code>和<code>assistant</code>三种，<code>content</code> 表示消息的内容。<ul><li><code>system</code>：系统消息，用来设置 ChatGPT 的行为。</li><li><code>user</code>：用户消息，用来和 ChatGPT 交互。</li><li><code>assistant</code>：助理消息，用来帮助你存储 ChatGPT 在此之前的回复。</li></ul></li></ul><p>来看一下完整的回复</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">21
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#6ab825;font-weight:700>&#34;choices&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#6ab825;font-weight:700>&#34;finish_reason&#34;</span>: <span style=color:#ed9d13>&#34;stop&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#6ab825;font-weight:700>&#34;index&#34;</span>: <span style=color:#3677a9>0</span>,
</span></span><span style=display:flex><span>      <span style=color:#6ab825;font-weight:700>&#34;message&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#6ab825;font-weight:700>&#34;content&#34;</span>: <span style=color:#ed9d13>&#34;The 2020 World Series was played at Globe Life Field in Arlington, Texas.&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#6ab825;font-weight:700>&#34;role&#34;</span>: <span style=color:#ed9d13>&#34;assistant&#34;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:#6ab825;font-weight:700>&#34;created&#34;</span>: <span style=color:#3677a9>1677759714</span>,
</span></span><span style=display:flex><span>  <span style=color:#6ab825;font-weight:700>&#34;id&#34;</span>: <span style=color:#ed9d13>&#34;chatcmpl-6pcEUG6zKP0Ld33OP1dZGbg3GwWhC&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#6ab825;font-weight:700>&#34;model&#34;</span>: <span style=color:#ed9d13>&#34;gpt-3.5-turbo-0301&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#6ab825;font-weight:700>&#34;object&#34;</span>: <span style=color:#ed9d13>&#34;chat.completion&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#6ab825;font-weight:700>&#34;usage&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#6ab825;font-weight:700>&#34;completion_tokens&#34;</span>: <span style=color:#3677a9>19</span>,
</span></span><span style=display:flex><span>    <span style=color:#6ab825;font-weight:700>&#34;prompt_tokens&#34;</span>: <span style=color:#3677a9>56</span>,
</span></span><span style=display:flex><span>    <span style=color:#6ab825;font-weight:700>&#34;total_tokens&#34;</span>: <span style=color:#3677a9>75</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>这其实就是一个多轮对话的栗子，如果是想动态的进行多轮对话，那么必须每次都将之前的回复都记录并传入才行。</p><p>首先我们设置了 <code>system</code> 的消息，这个消息的内容是 <code>You are a helpful assistant.</code>，随后我们设置了 <code>user</code> 的消息，这个消息的内容是 <code>Who won the world series in 2020?</code>，这个消息相当于前一轮对话的信息，然后我们设置了 <code>assistant</code> 的消息，这个消息的内容是 <code>The Los Angeles Dodgers won the World Series in 2020.</code>，意思是 ChatGPT 在上一轮的回复。最后我们又设置了 <code>user</code> 的消息，这个消息的内容是 <code>Where was it played?</code>，表示本轮消息的问题，也就是当前想让 GPT 回复的问题。</p><p>可以看到，收到的回复内容是 <code>The 2020 World Series was played at Globe Life Field in Arlington, Texas.</code>，我们询问时只询问了地点，而 ChatGPT 已经通过之前的回复，知道了这次的回复是关于 2020 年世界系列赛的，并且回答了这个问题。</p><p>同时，我们还可以看到 <code>usage</code> 字段，这个字段表示这次请求使用了多少 token，<code>prompt_tokens</code> 输入的 token 数量，<code>completion_tokens</code> 是 ChatGPT 回复的 token 数量，<code>total_tokens</code> 是总共使用的 token 数量，这一波消耗了 75 个 token。</p><h3 id=advanced-usage--2>Advanced Usage # 2<a hidden class=anchor aria-hidden=true href=#advanced-usage--2>#</a></h3><p>我们再来看一个更复杂的栗子</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">30
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>os</span>
</span></span><span style=display:flex><span><span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>openai</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>os.environ[<span style=color:#ed9d13>&#34;OPENAI_API_KEY&#34;</span>] = <span style=color:#ed9d13>&#34;sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#34;</span> <span style=color:#999;font-style:italic># replace with your API key</span>
</span></span><span style=display:flex><span>openai.api_key = os.getenv(<span style=color:#ed9d13>&#34;OPENAI_API_KEY&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>completion = openai.ChatCompletion.create(
</span></span><span style=display:flex><span>    model=<span style=color:#ed9d13>&#34;gpt-3.5-turbo&#34;</span>,
</span></span><span style=display:flex><span>    messages=[
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#ed9d13>&#34;role&#34;</span>: <span style=color:#ed9d13>&#34;user&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#ed9d13>&#34;content&#34;</span>: <span style=color:#ed9d13>&#39;I want you to act as an Chinese translator, spelling corrector and improver. I will speak to you in any language and you will detect the language, translate it and answer in the corrected and improved version of my text, in Chinese. I want you to replace my simplified A0-level words and sentences with more beautiful and elegant, upper level Chinese words and sentences. Keep the meaning same, but make them more literary. I want you to only reply the correction, the improvements and nothing else, do not write explanations. My first sentence is &#34;Non terrae plus ultra&#34;&#39;</span>,
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    temperature=<span style=color:#3677a9>0.9</span>,  <span style=color:#999;font-style:italic># 0.0 to 2.0 (default 1.0)</span>
</span></span><span style=display:flex><span>    top_p=<span style=color:#3677a9>1</span>,  <span style=color:#999;font-style:italic># 0.0 to 1.0 (default 1.0) (not used if temperature is set)</span>
</span></span><span style=display:flex><span>    n=<span style=color:#3677a9>5</span>,  <span style=color:#999;font-style:italic># number (default 1) How many chat completion choices to generate for each input message.</span>
</span></span><span style=display:flex><span>    stream=<span style=color:#6ab825;font-weight:700>False</span>,  <span style=color:#999;font-style:italic># boolean (default False)</span>
</span></span><span style=display:flex><span>    stop=<span style=color:#6ab825;font-weight:700>None</span>,  <span style=color:#999;font-style:italic># string or array (default None)</span>
</span></span><span style=display:flex><span>    max_tokens=<span style=color:#3677a9>10</span>,  <span style=color:#999;font-style:italic># inf (default 4096-prompt_token)</span>
</span></span><span style=display:flex><span>    presence_penalty=<span style=color:#3677a9>2.0</span>,  <span style=color:#999;font-style:italic># -2.0 to 2.0 (default 0)</span>
</span></span><span style=display:flex><span>    frequency_penalty=<span style=color:#3677a9>0</span>,  <span style=color:#999;font-style:italic># -2.0 to 2.0 (default 0)</span>
</span></span><span style=display:flex><span>    <span style=color:#999;font-style:italic># logit_bias=</span>
</span></span><span style=display:flex><span>    <span style=color:#999;font-style:italic># user=</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#24909d>print</span>(completion)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6ab825;font-weight:700>for</span> choice <span style=color:#6ab825;font-weight:700>in</span> completion.choices:
</span></span><span style=display:flex><span>    <span style=color:#24909d>print</span>(choice.message.content)
</span></span></code></pre></td></tr></table></div></div><blockquote><p>这里的 prompt 修改自 <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>，prompt 与我想解释的参数无关</p></blockquote><p>这里面涉及到了更多的参数：</p><ul><li><p><code>temperature</code>: 0.0 to 2.0 (默认 1.0) 温度，越高越随机，越低越有规律（或确定性）。</p></li><li><p><code>top_p</code>: 0.0 to 1.0 (默认 1.0) 使用温度的另一种选择，也叫核采样（nucleus sampling），建议不要同时使用 <code>temperature</code> 和 <code>top_p</code>。<code>top_p</code> 表示模型只考虑概率最高的 <code>top_p</code> 的 token，比如 <code>top_p=0.1</code>，表示模型只考虑概率最高的 10% 的 token。</p></li><li><p><code>n</code>: number (默认 1) 生成的回复数量。</p></li><li><p><code>stream</code>: boolean (默认 False) 是否使用流式模式，如果设置为 <code>True</code>，将发送部分消息增量，就像在 ChatGPT 中一样。什么意思捏，就是每次单独给你蹦几个词，好让你动态的去更新文本，像你在 ChatGPT 中等待完整的回复一样。</p></li><li><p><code>stop</code>: string or array (默认 None) 用来停止生成的 token，可以是一个字符串，也可以是一个字符串列表，如果是字符串列表，那么只要其中一个 token 出现，就会停止生成，最多 4 个。</p></li><li><p><code>max_tokens</code>: inf (默认 4096-prompt_token) 生成的最大 token 数量。</p></li><li><p><code>frequency_penalty</code> 和 <code>presence_penalty</code>: -2.0 to 2.0 (默认 0) 用来惩罚重复的 token。关于此参数的更多细节在 <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup> 中有介绍，看起来一个是处理的频率，一个是处理的存在次数（整数）。这两个参数的值越大，生成的文本越不会重复。</p><p>公式是这样的：</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>mu[j] -&gt; mu[j] - c[j] * alpha_frequency - float(c[j] &gt; 0) * alpha_presence
</span></span></code></pre></td></tr></table></div></div></li><li><p><code>logit_bias</code>: dict (默认 None) 用来调整 token 的概率，可以接受 json。数值是 -100 to 100，-100 相当于直接禁用这个词，100 相当于如果相关就必须使用。</p></li><li><p><code>user</code>: dict (默认 None) 用来设置用户的信息，具体内容可以参考 <sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>，主要是为了防止滥用。</p></li></ul><p>而这段代码的输出是下面内容（因为中文在 json 中会有转义，所以这里我把中文替换过了）。</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">53
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>{
</span></span><span style=display:flex><span>  &#34;choices&#34;: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      &#34;finish_reason&#34;: &#34;stop&#34;,
</span></span><span style=display:flex><span>      &#34;index&#34;: 0,
</span></span><span style=display:flex><span>      &#34;message&#34;: {
</span></span><span style=display:flex><span>        &#34;content&#34;: &#34;\&#34;天涯海角\&#34;&#34;,
</span></span><span style=display:flex><span>        &#34;role&#34;: &#34;assistant&#34;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      &#34;finish_reason&#34;: &#34;stop&#34;,
</span></span><span style=display:flex><span>      &#34;index&#34;: 1,
</span></span><span style=display:flex><span>      &#34;message&#34;: {
</span></span><span style=display:flex><span>        &#34;content&#34;: &#34;\n\n无穷尽之地&#34;,
</span></span><span style=display:flex><span>        &#34;role&#34;: &#34;assistant&#34;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      &#34;finish_reason&#34;: null,
</span></span><span style=display:flex><span>      &#34;index&#34;: 2,
</span></span><span style=display:flex><span>      &#34;message&#34;: {
</span></span><span style=display:flex><span>        &#34;content&#34;: &#34;\n\n\&#34;无出其右\&#34;&#34;,
</span></span><span style=display:flex><span>        &#34;role&#34;: &#34;assistant&#34;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      &#34;finish_reason&#34;: &#34;stop&#34;,
</span></span><span style=display:flex><span>      &#34;index&#34;: 3,
</span></span><span style=display:flex><span>      &#34;message&#34;: {
</span></span><span style=display:flex><span>        &#34;content&#34;: &#34;\n\n\&#34;无地不可至\&#34;&#34;,
</span></span><span style=display:flex><span>        &#34;role&#34;: &#34;assistant&#34;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      &#34;finish_reason&#34;: &#34;length&#34;,
</span></span><span style=display:flex><span>      &#34;index&#34;: 4,
</span></span><span style=display:flex><span>      &#34;message&#34;: {
</span></span><span style=display:flex><span>        &#34;content&#34;: &#34;\n\n无地可往，更远&#34;,
</span></span><span style=display:flex><span>        &#34;role&#34;: &#34;assistant&#34;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  &#34;created&#34;: 1677760749,
</span></span><span style=display:flex><span>  &#34;id&#34;: &#34;chatcmpl-6pcVBkXoD9xr2CSioR1Gz3ubEOdpg&#34;,
</span></span><span style=display:flex><span>  &#34;model&#34;: &#34;gpt-3.5-turbo-0301&#34;,
</span></span><span style=display:flex><span>  &#34;object&#34;: &#34;chat.completion&#34;,
</span></span><span style=display:flex><span>  &#34;usage&#34;: {
</span></span><span style=display:flex><span>    &#34;completion_tokens&#34;: 45,
</span></span><span style=display:flex><span>    &#34;prompt_tokens&#34;: 124,
</span></span><span style=display:flex><span>    &#34;total_tokens&#34;: 169
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=advanced-usage--3>Advanced Usage # 3<a hidden class=anchor aria-hidden=true href=#advanced-usage--3>#</a></h3><p>这里是关于 <code>steam</code> 参数的一个栗子</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">30
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>os</span>
</span></span><span style=display:flex><span><span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>openai</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>os.environ[<span style=color:#ed9d13>&#34;OPENAI_API_KEY&#34;</span>] = <span style=color:#ed9d13>&#34;sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#34;</span>
</span></span><span style=display:flex><span>openai.api_key = os.getenv(<span style=color:#ed9d13>&#34;OPENAI_API_KEY&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>completion = openai.ChatCompletion.create(
</span></span><span style=display:flex><span>    model=<span style=color:#ed9d13>&#34;gpt-3.5-turbo&#34;</span>,
</span></span><span style=display:flex><span>    messages=[
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#ed9d13>&#34;role&#34;</span>: <span style=color:#ed9d13>&#34;user&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#ed9d13>&#34;content&#34;</span>: <span style=color:#ed9d13>&#39;I want you to act as an Chinese translator, spelling corrector and improver. I will speak to you in any language and you will detect the language, translate it and answer in the corrected and improved version of my text, in Chinese. I want you to replace my simplified A0-level words and sentences with more beautiful and elegant, upper level Chinese words and sentences. Keep the meaning same, but make them more literary. I want you to only reply the correction, the improvements and nothing else, do not write explanations. My first sentence is &#34;Non terrae plus ultra&#34;&#39;</span>,
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    temperature=<span style=color:#3677a9>1</span>,  <span style=color:#999;font-style:italic># 0.0 to 2.0 (default 1.0)</span>
</span></span><span style=display:flex><span>    top_p=<span style=color:#3677a9>1</span>,  <span style=color:#999;font-style:italic># 0.0 to 1.0 (default 1.0) (not used if temperature is set)</span>
</span></span><span style=display:flex><span>    n=<span style=color:#3677a9>1</span>,  <span style=color:#999;font-style:italic># number (default 1) How many chat completion choices to generate for each input message.</span>
</span></span><span style=display:flex><span>    stream=<span style=color:#6ab825;font-weight:700>True</span>,  <span style=color:#999;font-style:italic># boolean (default False)</span>
</span></span><span style=display:flex><span>    stop=<span style=color:#6ab825;font-weight:700>None</span>,  <span style=color:#999;font-style:italic># string or array (default None)</span>
</span></span><span style=display:flex><span>    <span style=color:#999;font-style:italic># max_tokens=100,  # inf (default 4096-prompt_token)</span>
</span></span><span style=display:flex><span>    presence_penalty=<span style=color:#3677a9>2.0</span>,  <span style=color:#999;font-style:italic># -2.0 to 2.0 (default 0)</span>
</span></span><span style=display:flex><span>    frequency_penalty=<span style=color:#3677a9>0</span>,  <span style=color:#999;font-style:italic># -2.0 to 2.0 (default 0)</span>
</span></span><span style=display:flex><span>    <span style=color:#999;font-style:italic># logit_bias=</span>
</span></span><span style=display:flex><span>    <span style=color:#999;font-style:italic># user=</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6ab825;font-weight:700>for</span> completion_ <span style=color:#6ab825;font-weight:700>in</span> completion:
</span></span><span style=display:flex><span>    <span style=color:#999;font-style:italic># print(completion_)</span>
</span></span><span style=display:flex><span>    <span style=color:#6ab825;font-weight:700>for</span> choice <span style=color:#6ab825;font-weight:700>in</span> completion_.choices:
</span></span><span style=display:flex><span>        <span style=color:#24909d>print</span>(choice.delta.content <span style=color:#6ab825;font-weight:700>if</span> <span style=color:#ed9d13>&#34;content&#34;</span> <span style=color:#6ab825;font-weight:700>in</span> choice.delta <span style=color:#6ab825;font-weight:700>else</span> <span style=color:#ed9d13>&#34;&#34;</span>)
</span></span></code></pre></td></tr></table></div></div><p>开启 Stream 模式后，返回的会是流式数据，而不是返回一个包含所有数据的对象，并且这个返回的对象是可以迭代的。下面是返回的一个 item 样例，这里注意 <code>delta</code> 中未必会有 <code>content</code>，所以需要判断一下。</p><blockquote><p>也就是说，其实 ChatGPT 在输出前就已经得到了完整的结果，他一个词一个词蹦纯属在前端拖延你的时间？！</p></blockquote><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>{
</span></span><span style=display:flex><span>  &#34;choices&#34;: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      &#34;delta&#34;: {
</span></span><span style=display:flex><span>        &#34;content&#34;: &#34;\uff1f&#34;
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      &#34;finish_reason&#34;: null,
</span></span><span style=display:flex><span>      &#34;index&#34;: 0
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  &#34;created&#34;: 1677763452,
</span></span><span style=display:flex><span>  &#34;id&#34;: &#34;chatcmpl-6pdCm5jwsB1e3YyEDZ1MQXbpHzWvn&#34;,
</span></span><span style=display:flex><span>  &#34;model&#34;: &#34;gpt-3.5-turbo-0301&#34;,
</span></span><span style=display:flex><span>  &#34;object&#34;: &#34;chat.completion.chunk&#34;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=advanced-usage--4>Advanced Usage # 4<a hidden class=anchor aria-hidden=true href=#advanced-usage--4>#</a></h3><p>这是一个关于 <code>stop</code> 参数的栗子</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">28
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>os</span>
</span></span><span style=display:flex><span><span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>openai</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>os.environ[<span style=color:#ed9d13>&#34;OPENAI_API_KEY&#34;</span>] = <span style=color:#ed9d13>&#34;sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#34;</span>
</span></span><span style=display:flex><span>openai.api_key = os.getenv(<span style=color:#ed9d13>&#34;OPENAI_API_KEY&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>completion = openai.ChatCompletion.create(
</span></span><span style=display:flex><span>    model=<span style=color:#ed9d13>&#34;gpt-3.5-turbo&#34;</span>,
</span></span><span style=display:flex><span>    messages=[
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#ed9d13>&#34;role&#34;</span>: <span style=color:#ed9d13>&#34;user&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#ed9d13>&#34;content&#34;</span>: <span style=color:#ed9d13>&#39;I want you to act as an Chinese translator, spelling corrector and improver. I will speak to you in any language and you will detect the language, translate it and answer in the corrected and improved version of my text, in Chinese. I want you to replace my simplified A0-level words and sentences with more beautiful and elegant, upper level Chinese words and sentences. Keep the meaning same, but make them more literary. I want you to only reply the correction, the improvements and nothing else, do not write explanations. My first sentence is &#34;Non terrae plus ultra&#34;&#39;</span>,
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    temperature=<span style=color:#3677a9>1</span>,  <span style=color:#999;font-style:italic># 0.0 to 2.0 (default 1.0)</span>
</span></span><span style=display:flex><span>    top_p=<span style=color:#3677a9>1</span>,  <span style=color:#999;font-style:italic># 0.0 to 1.0 (default 1.0) (not used if temperature is set)</span>
</span></span><span style=display:flex><span>    n=<span style=color:#3677a9>1</span>,  <span style=color:#999;font-style:italic># number (default 1) How many chat completion choices to generate for each input message.</span>
</span></span><span style=display:flex><span>    stream=<span style=color:#6ab825;font-weight:700>False</span>,  <span style=color:#999;font-style:italic># boolean (default False)</span>
</span></span><span style=display:flex><span>    stop=<span style=color:#ed9d13>&#34;无&#34;</span>,  <span style=color:#999;font-style:italic># string or array (default None)</span>
</span></span><span style=display:flex><span>    <span style=color:#999;font-style:italic># max_tokens=100,  # inf (default 4096-prompt_token)</span>
</span></span><span style=display:flex><span>    presence_penalty=<span style=color:#3677a9>0</span>,  <span style=color:#999;font-style:italic># -2.0 to 2.0 (default 0)</span>
</span></span><span style=display:flex><span>    frequency_penalty=<span style=color:#3677a9>0</span>,  <span style=color:#999;font-style:italic># -2.0 to 2.0 (default 0)</span>
</span></span><span style=display:flex><span>    <span style=color:#999;font-style:italic># logit_bias=</span>
</span></span><span style=display:flex><span>    <span style=color:#999;font-style:italic># user=</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6ab825;font-weight:700>for</span> choice <span style=color:#6ab825;font-weight:700>in</span> completion.choices:
</span></span><span style=display:flex><span>    <span style=color:#24909d>print</span>(choice.message.content)
</span></span></code></pre></td></tr></table></div></div><p>这里我们依然让他扮演一个翻译的角色，来翻译 Apex Legends 中动力小子的一句台词，用 &ldquo;无&rdquo; 作为停止条件，当输出的结果中遇到 &ldquo;无&rdquo; 时，就停止并返回结果。输出如下：</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>您好，您所给出的第一句话“Non terrae plus ultra”是拉丁语，意为“没有比这更远的土地”，翻译成中文可写作“
</span></span></code></pre></td></tr></table></div></div><blockquote><p>可以看到输出直接给断开了，并且会将中断的词自动转为 token，不过我暂时还没想到有啥应用场景 - -</p></blockquote><h3 id=error>Error<a hidden class=anchor aria-hidden=true href=#error>#</a></h3><p>在使用的时候我有好几次触发了这个错误，并不是我请求格式的问题，大概是同时请求的人太多了，所以会出现这个错误，这个错误的信息是下面这样的：</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 7d8d2f6b67d92ff7850ef3e17d742827 in your email.) {
</span></span><span style=display:flex><span>  &#34;error&#34;: {
</span></span><span style=display:flex><span>    &#34;message&#34;: &#34;The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 7d8d2f6b67d92ff7850ef3e17d742827 in your email.)&#34;,
</span></span><span style=display:flex><span>    &#34;type&#34;: &#34;server_error&#34;,
</span></span><span style=display:flex><span>    &#34;param&#34;: null,
</span></span><span style=display:flex><span>    &#34;code&#34;: null
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 500 {&#39;error&#39;: {&#39;message&#39;: &#39;The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 7d8d2f6b67d92ff7850ef3e17d742827 in your email.)&#39;, &#39;type&#39;: &#39;server_error&#39;, &#39;param&#39;: None, &#39;code&#39;: None}} {&#39;Date&#39;: &#39;Thu, 02 Mar 2023 12:37:21 GMT&#39;, &#39;Content-Type&#39;: &#39;application/json&#39;, &#39;Content-Length&#39;: &#39;366&#39;, &#39;Connection&#39;: &#39;keep-alive&#39;, &#39;Access-Control-Allow-Origin&#39;: &#39;*&#39;, &#39;Openai-Model&#39;: &#39;gpt-3.5-turbo-0301&#39;, &#39;Openai-Organization&#39;: &#39;user-8qnumkqgd3l02hvzq5rqz0y1&#39;, &#39;Openai-Processing-Ms&#39;: &#39;750&#39;, &#39;Openai-Version&#39;: &#39;2020-10-01&#39;, &#39;Strict-Transport-Security&#39;: &#39;max-age=15724800; includeSubDomains&#39;, &#39;X-Request-Id&#39;: &#39;7d8d2f6b67d92ff7850ef3e17d742827&#39;}
</span></span></code></pre></td></tr></table></div></div><h2 id=结语>结语<a hidden class=anchor aria-hidden=true href=#结语>#</a></h2><p>这个定价我只能说，实在是太便宜了，感觉很多公司可能都不会去想办法复现了，直接调包，性能好，不需要担心成本、电费、算力等种种因素，价格还便宜。我感觉小公司就算有自己模型，光算力和电力成本可能比 API 高不少，毕竟这也是一个利用率的问题。</p><p>另外我感觉这个其实也一定程度上改变了翻译市场，以腾讯云的翻译 API 为例，他的价格稍微计算一下，大概是 GPT 3.5 Turbo API 价格的 3 倍左右，但是算上输入的 token，也就 1.5 倍吧，但是附赠了其他功能，包括改写润色。</p><figure><img loading=lazy src=/img/blog-advantage-usage-for-gpt-3-5-turbo/tencent-cloud-price.png#center alt="腾讯云翻译 API 价格"><figcaption><p style=text-align:center>腾讯云翻译 API 价格</p></figcaption></figure><p>通过体验也可以发现，如果你每次都是长文本输入，其实消耗 token 还是挺快的，输入输出都会计费。同时，如果你想进行 session 级别的对话，那么你消耗的 token 也会增长很快，每次 * 2，再累计，也就是平方级别的了，所以长对话的消耗其实还是挺大的。</p><p>不过，遗憾的是，目前 OpenAI 只支持虚拟信用卡支付，国内用户想自费使用的话，可能还得有些自己的手段。</p><p>还记得，去年 9 月份我写了一篇博客来讲讲我对 Stable Diffusion 的想法<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup>，现在再来看看 SD 模型，简直像是差了一个世纪&mldr;lora、ControlNet&mldr;如果说 SD 只是影响到了艺术、设计领域，那么 ChatGPT 的大模型潜力是真的很大，会影响很多的行业，因为输出的多样性实在是太丰富了，比如可能会有人用他来输出一段代码，驱动机器等等<sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup>&mldr;应用的场景完全取决于想象力了，但目前也存在科学性的问题，如果有一个更强大的知识库来建立，输出时给予理论依据，那么这个模型的应用场景就会更加广泛，比如医疗、金融等等，对证据、决策要求更高的领域也会大放异彩。</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://openai.com/blog/introducing-chatgpt-and-whisper-apis>https://openai.com/blog/introducing-chatgpt-and-whisper-apis</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://platform.openai.com/docs/guides/chat>https://platform.openai.com/docs/guides/chat</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://github.com/f/awesome-chatgpt-prompts>https://github.com/f/awesome-chatgpt-prompts</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><a href=https://platform.openai.com/docs/api-reference/parameter-details>https://platform.openai.com/docs/api-reference/parameter-details</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p><a href=https://platform.openai.com/docs/guides/safety-best-practices/end-user-ids>https://platform.openai.com/docs/guides/safety-best-practices/end-user-ids</a>&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p><a href=https://blog.bj-yan.top/p/blog-will-ai-replace-the-artists/>https://blog.bj-yan.top/p/blog-will-ai-replace-the-artists/</a>&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7><p><a href=https://github.com/microsoft/PromptCraft-Robotics>https://github.com/microsoft/PromptCraft-Robotics</a>&#160;<a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><div class=post-copyright-div><ul class=post-copyright><div class=post-copyright-title><p>Advantage Usage for GPT 3.5 Turbo API</p><p><a href=https://blog.bj-yan.top/p/blog-advantage-usage-for-gpt-3-5-turbo/>https://blog.bj-yan.top/p/blog-advantage-usage-for-gpt-3-5-turbo/</a></p></div><div class="post-copy-meta level is-mobile"><div class=level-left><div class="level-item is-narrow"><div><h6>作者</h6><p>北屿</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>March 2, 2023</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>March 21, 2023</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class=icons rel=noopener target=_blank title="Creative Commons" href=https://creativecommons.org/><i class="icon fab fa-creative-commons"></i></a>
<a class=icons rel=noopener target=_blank title=Attribution href=https://creativecommons.org/licenses/by/4.0/><i class="icon fab fa-creative-commons-by"></i></a>
<a class=icons rel=noopener target=_blank title=Noncommercial href=https://creativecommons.org/licenses/by-nc/4.0/><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></ul></div><ul class=post-tags><li><a href=https://blog.bj-yan.top/tags/blog/>Blog</a></li><li><a href=https://blog.bj-yan.top/tags/aigc/>Aigc</a></li><li><a href=https://blog.bj-yan.top/tags/gpt/>Gpt</a></li><li><a href=https://blog.bj-yan.top/tags/openai/>Openai</a></li><li><a href=https://blog.bj-yan.top/tags/chatgpt/>Chatgpt</a></li></ul><nav class=paginav><a class=prev href=https://blog.bj-yan.top/p/misc-games-rank-diamond/><span class=title>«</span><br><span>杂记：钻石分段</span>
</a><a class=next href=https://blog.bj-yan.top/p/blog-github-useless-tips/><span class=title>»</span><br><span>GitHub 没啥用小技巧</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Advantage Usage for GPT 3.5 Turbo API on twitter" href="https://twitter.com/intent/tweet/?text=Advantage%20Usage%20for%20GPT%203.5%20Turbo%20API&amp;url=https%3a%2f%2fblog.bj-yan.top%2fp%2fblog-advantage-usage-for-gpt-3-5-turbo%2f&amp;hashtags=blog%2caigc%2cgpt%2copenai%2cchatgpt"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Advantage Usage for GPT 3.5 Turbo API on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.bj-yan.top%2fp%2fblog-advantage-usage-for-gpt-3-5-turbo%2f&amp;title=Advantage%20Usage%20for%20GPT%203.5%20Turbo%20API&amp;summary=Advantage%20Usage%20for%20GPT%203.5%20Turbo%20API&amp;source=https%3a%2f%2fblog.bj-yan.top%2fp%2fblog-advantage-usage-for-gpt-3-5-turbo%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Advantage Usage for GPT 3.5 Turbo API on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.bj-yan.top%2fp%2fblog-advantage-usage-for-gpt-3-5-turbo%2f&title=Advantage%20Usage%20for%20GPT%203.5%20Turbo%20API"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Advantage Usage for GPT 3.5 Turbo API on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.bj-yan.top%2fp%2fblog-advantage-usage-for-gpt-3-5-turbo%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Advantage Usage for GPT 3.5 Turbo API on whatsapp" href="https://api.whatsapp.com/send?text=Advantage%20Usage%20for%20GPT%203.5%20Turbo%20API%20-%20https%3a%2f%2fblog.bj-yan.top%2fp%2fblog-advantage-usage-for-gpt-3-5-turbo%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Advantage Usage for GPT 3.5 Turbo API on telegram" href="https://telegram.me/share/url?text=Advantage%20Usage%20for%20GPT%203.5%20Turbo%20API&amp;url=https%3a%2f%2fblog.bj-yan.top%2fp%2fblog-advantage-usage-for-gpt-3-5-turbo%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer><div class=reward-container><div>Have fun.</div><button onclick='var qr=document.getElementById("qr");qr.style.display=qr.style.display==="none"?"block":"none"'>Donate</button><div id=qr style=display:none><div style=display:inline-block><img src=/donate/alipay.png alt=alipay><p>alipay</p></div><div style=display:inline-block><img src=/donate/wechatpay.png alt=wechatpay><p>wechatpay</p></div></div></div><div class=comments><div id=comment-giscus></div></div><script>var gis,iframes,path="/p/blog-advantage-usage-for-gpt-3-5-turbo/",path=path.substring(path.indexOf("/")+1),path=decodeURI(path);console.log(path),gis=document.createElement("script"),gis.type="text/javascript",gis.async=!0,gis.setAttribute("src","https://giscus.app/client.js"),gis.setAttribute("data-repo","beiyuouo/blog-comment"),gis.setAttribute("data-repo-id","R_kgDOGF_a6w"),gis.setAttribute("data-category","General"),gis.setAttribute("data-category-id","DIC_kwDOGF_a684B_YGN"),gis.setAttribute("data-mapping","pathname"),gis.setAttribute("data-strict",0),gis.setAttribute("data-reactions-enabled","1"),gis.setAttribute("data-emit-metadata","0"),gis.setAttribute("data-input-position","top"),gis.setAttribute("data-theme","transparent_dark"),gis.setAttribute("data-lang","en"),gis.setAttribute("data-loading","lazy"),gis.setAttribute("crossorigin","anonymous"),iframes=document.getElementsByTagName("iframe"),document.getElementById("comment-giscus").appendChild(gis)</script></article></main><footer class=footer><span>&copy; 2025 <a href=https://blog.bj-yan.top/>小冰爱吃盐</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span><br><span id=busuanzi_container_page_pv>本文总阅读量<span id=busuanzi_value_page_pv></span>次
</span><span id=busuanzi_container_site_pv>本站总访问量<span id=busuanzi_value_site_pv></span>次
</span><span id=busuanzi_container_site_uv>本站访客数<span id=busuanzi_value_site_uv></span>人次
</span><script type=text/javascript id=mapmyvisitors src="//mapmyvisitors.com/map.js?d=Y4m14m4Jh2bS4Vyr_FP_8YF3q3_awg-YnkQxkAdOtIw&cl=ffffff&w=200"></script></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>